#ifndef PDGSIGMA_H
#define PDGSIGMA_H

#include "Pythia8/Pythia.h"

static double interpol(vector<pair<double, double>> data, double x) {
  if (x < data[0].first)
    return data[0].second;
  else if (x > data[data.size() - 1].first)
    return data[data.size() - 1].second;

  for (size_t i = 0; i < data.size() - 1; i++) {
    if (data[i + 1].first >= x) {
      double t = (x - data[i].first) / (data[i + 1].first - data[i].first);
      return (1 - t) * data[i].second + t * data[i + 1].second;
    }
  }

}

static vector<pair<double, double>> ppbarTotal {
  {0.18100,339.40},{0.21900,292.10},
  {0.22190,317.71},{0.22960,304.67},{0.23700,297.12},{0.23900,261.20},
  {0.23900,261.20},{0.24990,286.47},{0.25490,279.66},{0.25880,273.95},
  {0.26080,273.89},{0.26100,252.40},{0.26100,252.40},{0.26560,265.22},
  {0.26810,264.79},{0.27170,262.94},{0.27330,263.25},{0.27350,261.06},
  {0.28030,262.17},{0.28040,257.11},{0.28110,260.39},{0.28700,229.30},
  {0.28700,229.30},{0.28910,250.38},{0.28910,251.64},{0.29390,247.94},
  {0.29406,281.00},{0.29480,246.24},{0.29730,245.90},{0.30460,242.78},
  {0.30550,239.88},{0.30600,238.50},{0.30680,241.03},{0.31180,236.03},
  {0.31610,235.97},{0.31870,234.65},{0.31940,233.65},{0.32680,229.44},
  {0.32770,229.93},{0.33570,226.90},{0.33600,226.60},{0.33810,225.35},
  {0.34560,222.89},{0.34870,224.50},{0.34940,219.98},{0.35330,220.90},
  {0.35470,217.55},{0.35500,208.00},{0.36000,217.40},{0.36090,215.02},
  {0.36480,214.94},{0.37180,210.76},{0.37320,201.50},{0.37400,203.90},
  {0.37520,209.83},{0.38100,202.30},{0.38170,207.31},{0.38510,206.37},
  {0.38800,204.75},{0.38800,193.80},{0.39220,203.49},{0.39420,204.38},
  {0.39590,187.00},{0.39590,187.00},{0.39900,192.90},{0.40210,198.84},
  {0.40390,201.38},{0.40455,199.70},{0.40600,198.60},{0.40740,194.00},
  {0.40790,189.70},{0.40790,189.70},{0.41053,198.40},{0.41320,196.79},
  {0.41600,193.20},{0.41700,186.70},{0.41890,188.50},{0.41890,188.50},
  {0.42070,185.00},{0.42240,194.14},{0.43010,185.30},{0.43010,185.30},
  {0.43100,188.90},{0.43570,181.00},{0.43750,187.91},{0.44040,183.70},
  {0.44150,176.20},{0.44150,176.20},{0.44200,178.50},{0.44412,188.00},
  {0.44500,184.60},{0.44600,188.40},{0.44797,187.00},{0.45100,184.89},
  {0.45290,177.10},{0.45290,177.10},{0.45390,179.50},{0.45500,178.60},
  {0.45800,183.40},{0.46200,182.67},{0.46320,174.40},{0.46320,174.40},
  {0.46620,169.20},{0.46746,179.50},{0.46800,173.40},{0.47100,177.90},
  {0.47220,179.42},{0.47363,177.90},{0.47540,169.40},{0.47540,169.40},
  {0.47820,175.10},{0.47910,176.80},{0.47930,176.30},{0.48000,172.20},
  {0.48200,183.70},{0.48460,176.39},{0.48660,177.20},{0.48710,169.40},
  {0.48710,169.40},{0.48790,180.90},{0.49030,176.08},{0.49077,175.70},
  {0.49200,169.10},{0.49300,178.30},{0.49560,174.35},{0.49740,172.40},
  {0.49770,166.00},{0.49770,166.00},{0.49870,171.10},{0.49890,170.60},
  {0.49920,173.53},{0.50260,175.30},{0.50290,174.70},{0.50400,167.40},
  {0.50400,174.50},{0.50480,171.18},{0.50500,162.70},{0.50500,162.70},
  {0.50530,164.50},{0.50590,159.20},{0.50800,173.30},{0.50990,164.90},
  {0.50990,164.90},{0.51020,172.01},{0.51310,171.10},{0.51390,168.89},
  {0.51400,171.20},{0.51483,172.20},{0.51600,165.20},{0.51698,166.00},
  {0.52000,169.34},{0.52200,161.90},{0.52200,161.90},{0.52400,167.60},
  {0.52481,169.20},{0.52510,167.89},{0.52510,155.00},{0.52800,163.10},
  {0.53000,167.94},{0.53300,160.90},{0.53360,162.10},{0.53420,158.90},
  {0.53420,158.90},{0.53812,168.40},{0.54000,159.90},{0.54020,164.82},
  {0.54141,163.00},{0.54200,161.40},{0.54210,151.50},{0.54740,157.80},
  {0.54740,157.80},{0.55000,163.84},{0.55100,158.20},{0.55100,156.50},
  {0.55312,167.60},{0.55640,150.30},{0.55690,156.60},{0.55920,153.50},
  {0.55920,153.50},{0.55950,162.37},{0.56114,164.60},{0.56300,156.10},
  {0.56820,151.20},{0.56900,160.19},{0.57160,153.50},{0.57160,153.50},
  {0.57500,167.40},{0.57715,161.10},{0.57830,157.20},{0.57880,158.65},
  {0.58395,160.90},{0.58480,150.40},{0.58480,150.40},{0.58500,151.80},
  {0.58860,156.53},{0.59000,140.00},{0.59000,140.00},{0.59660,149.60},
  {0.59750,148.70},{0.59750,148.70},{0.59860,155.74},{0.59918,154.30},
  {0.60800,147.60},{0.61010,145.10},{0.61010,145.10},{0.61230,143.00},
  {0.62400,145.00},{0.62400,145.00},{0.62661,135.00},{0.62900,156.30},
  {0.63000,145.10},{0.63433,153.30},{0.63620,138.10},{0.63770,143.40},
  {0.63770,143.40},{0.63913,152.00},{0.65100,143.30},{0.65210,142.80},
  {0.65210,142.80},{0.65780,141.10},{0.66174,149.60},{0.66420,138.90},
  {0.66420,138.90},{0.67300,139.40},{0.67860,139.40},{0.67860,139.40},
  {0.68000,137.00},{0.68100,144.30},{0.68240,136.30},{0.68923,145.50},
  {0.69400,138.10},{0.69400,137.40},{0.69400,137.40},{0.69606,131.40},
  {0.70000,127.40},{0.70030,129.40},{0.70200,140.00},{0.70790,135.60},
  {0.70790,135.60},{0.71500,136.50},{0.71690,129.50},{0.72096,118.00},
  {0.72260,134.20},{0.72260,134.20},{0.73300,142.10},{0.73410,128.90},
  {0.73700,134.30},{0.73740,137.00},{0.73740,137.00},{0.75333,124.00},
  {0.75700,135.00},{0.75800,130.60},{0.76000,134.00},{0.76800,130.40},
  {0.77900,130.70},{0.78500,132.70},{0.78900,129.40},{0.79900,128.40},
  {0.80806,104.00},{0.81000,126.30},{0.82000,127.10},{0.83100,125.60},
  {0.83700,128.00},{0.84100,124.60},{0.85777,114.00},{0.86200,124.00},
  {0.86700,120.70},{0.88200,122.50},{0.88800,116.80},{0.90300,122.20},
  {0.92300,119.80},{0.94400,118.00},{0.96400,117.30},{0.97200,120.50},
  {0.98500,116.30},{1.00000,117.42},{1.00500,114.90},{1.02500,115.20},
  {1.04600,114.50},{1.05000,114.59},{1.06600,114.60},{1.07400,113.30},
  {1.09008,97.000},{1.10000,111.64},{1.11000,112.60},{1.13456,118.00},
  {1.15000,110.11},{1.17800,111.60},{1.20000,108.96},{1.25000,107.75},
  {1.30000,106.47},{1.31000,109.60},{1.33000,108.40},{1.34297,94.000},
  {1.34297,116.00},{1.34500,105.50},{1.35000,106.70},{1.38000,103.30},
  {1.40000,102.78},{1.45000,101.12},{1.48227,108.00},{1.49000,100.26},
  {1.52000,99.700},{1.55000,98.820},{1.60000,97.810},{1.63000,97.570},
  {1.63636,96.000},{1.65000,97.050},{1.68300,96.170},{1.69604,100.00},
  {1.70000,96.460},{1.75000,95.610},{1.77000,95.320},{1.77335,96.000},
  {1.80600,94.480},{1.83000,94.140},{1.85000,93.710},{1.87500,93.050},
  {1.88000,92.750},{1.88400,87.830},{1.90000,92.520},{1.92500,92.070},
  {1.95000,91.380},{1.95000,91.360},{1.97691,89.000},{2.00000,90.230},
  {2.05000,88.840},{2.08200,88.480},{2.09500,88.460},{2.15000,87.390},
  {2.20000,86.810},{2.20000,86.310},{2.25000,85.620},{2.28500,83.760},
  {2.30000,85.000},{2.32000,84.800},{2.35000,84.450},{2.40000,83.660},
  {2.45000,83.160},{2.48500,78.040},{2.50000,82.320},{2.50000,79.400},
  {2.55000,81.640},{2.60000,81.120},{2.65000,80.610},{2.68600,79.330},
  {2.70000,79.900},{2.75000,79.470},{2.78444,80.000},{2.80000,78.910},
  {2.85000,78.210},{2.88600,77.820},{2.90000,77.790},{2.94000,74.300},
  {2.95000,77.230},{3.00000,76.680},{3.00000,79.900},{3.05000,76.290},
  {3.06800,75.240},{3.10000,75.660},{3.15000,75.160},{3.20000,74.660},
  {3.24000,72.900},{3.25000,74.200},{3.28000,71.700},{3.30000,73.670},
  {3.54000,69.700},{3.60000,76.200},{3.66000,71.700},{3.86000,67.700},
  {4.00000,71.000},{4.01500,66.840},{4.30000,60.600},{4.70000,65.800},
  {5.35000,57.900},{6.00000,59.300},{6.65000,59.500},{6.94000,58.700},
  {7.30000,58.300},{8.00000,56.400},{9.14000,57.510},{10.00000,54.700},
  {12.00000,51.700},{13.20000,51.400},{14.00000,50.700},{15.00000,51.000},
  {16.00000,49.200},{18.00000,50.300},{20.00000,49.000},{20.00000,48.200},
  {23.00000,47.400},{25.00000,46.100},{25.00000,47.000},{27.50000,46.300},
  {30.00000,47.100},{30.00000,45.600},{30.00000,45.400},{31.00000,46.100},
  {32.10000,45.630},{33.50000,45.600},{35.00000,45.500},{35.00000,45.300},
  {35.00000,45.460},{37.50000,44.700},{40.00000,45.000},{40.00000,45.000},
  {40.00000,44.000},{42.50000,44.500},{45.00000,44.400},{47.50000,44.100},
  {50.00000,43.100},{50.00000,43.930},{50.00000,43.860}
};

static vector<pair<double, double>> ppbarElastic {
  {0.15367,93.700},{0.23916,89.000},{0.29406,80.000},{0.30600,74.700},
  {0.31037,86.500},{0.33600,75.700},{0.34870,77.600},{0.36000,73.100},
  {0.38100,71.100},{0.39900,68.000},{0.40455,71.100},{0.41600,65.500},
  {0.42070,66.000},{0.43100,66.400},{0.44412,68.700},{0.44500,63.600},
  {0.45800,64.800},{0.45899,66.000},{0.46746,62.000},{0.47100,64.800},
  {0.48200,63.700},{0.49300,64.200},{0.49870,62.600},{0.50000,65.700},
  {0.50400,60.700},{0.51400,56.500},{0.51698,72.000},{0.52400,59.000},
  {0.52481,59.500},{0.53133,77.000},{0.53300,55.500},{0.54141,52.000},
  {0.54200,54.900},{0.55100,51.700},{0.55312,63.500},{0.57715,61.300},
  {0.58749,56.000},{0.59918,57.300},{0.63913,64.000},{0.69000,53.400},
  {0.69606,51.200},{0.72096,45.000},{0.75333,50.000},{0.76000,47.300},
  {0.79000,49.300},{0.85777,49.000},{0.86000,47.200},{0.99000,44.500},
  {1.09000,44.200},{1.11000,43.800},{1.13456,42.000},{1.14000,43.800},
  {1.23000,43.300},{1.23000,42.100},{1.24000,43.200},{1.30000,41.500},
  {1.30000,41.300},{1.32000,43.300},{1.33000,41.300},{1.34297,42.000},
  {1.36000,40.100},{1.36000,42.200},{1.43000,41.800},{1.43000,38.700},
  {1.48227,38.000},{1.50000,37.500},{1.51000,39.400},{1.52000,39.300},
  {1.54000,38.500},{1.60000,37.600},{1.62000,37.200},{1.63636,33.000},
  {1.65000,38.100},{1.69604,33.000},{1.71000,37.000},{1.77335,30.000},
  {1.80000,36.100},{1.81000,35.700},{1.86000,35.200},{1.91000,33.900},
  {1.95000,35.400},{1.97691,28.000},{2.01000,32.400},{2.12000,31.800},
  {2.15000,30.800},{2.23000,30.400},{2.32000,29.000},{2.32000,29.000},
  {2.33000,29.800},{2.43000,28.600},{2.45000,27.400},{2.60000,25.900},
  {2.69000,25.600},{2.75000,25.600},{2.78444,25.000},{2.90000,24.500},
  {3.00000,23.700},{3.28000,21.900},{3.60000,20.900},{3.65000,20.600},
  {4.00000,19.750},{5.00000,16.000},{5.70000,16.300},{5.70000,15.900},
  {6.00000,15.600},{6.90000,14.700},{6.94000,14.200},{7.19990,13.790},
  {7.30000,13.650},{8.00000,12.880},{8.00000,12.700},{8.80000,12.330},
  {8.89990,13.890},{9.14000,11.750},{10.00000,14.600},{12.00000,11.340},
  {12.00000,11.590},{12.00000,11.590},{16.00000,9.4000},{16.00000,9.1000},
  {25.20000,8.6700},{32.10000,8.6800},{32.10000,8.2100},{40.10000,7.1700},
  {48.90000,7.8100},{50.00000,8.2000}
};

static vector<pair<double, double>> npbarTotal {
  {1.13456,119.00},{1.34297,96.000},{1.48227,112.00},
  {1.63636,102.00},{1.77335,109.00},{3.50000,68.300},{5.55000,55.000},
  {6.00000,59.500},{6.65000,56.000},{8.00000,57.300},{10.00000,51.800},
  {12.00000,53.800},{13.30000,49.600},{14.00000,53.400},{15.00000,46.900},
  {16.00000,52.700},{18.00000,44.400},{20.00000,46.000},{20.00000,46.200},
  {25.00000,45.300},{25.00000,45.500},{30.00000,44.900},{30.00000,45.000},
  {35.00000,45.900},{35.00000,44.100},{35.00000,45.640},{40.00000,42.300},
  {40.00000,43.200},{45.00000,43.700},{45.00000,44.600},{50.00000,43.880},
  {50.00000,42.500},{50.00000,43.690},{50.00000,44.100},{70.00000,43.180}
};

static vector<pair<double, double>> npbarElastic {
{1.13456,40.000},{1.34297,25.000},{1.48227,44.000},{1.63636,39.000},
{1.77335,42.000},{3.50000,20.600},{5.55000,16.500}
};

void initPDGData() {
  for (int i = 0; i < ppbarTotal.size() - 1; i++) {
    if (ppbarTotal[i].first == ppbarTotal[i + 1].first) {
      ppbarTotal.erase(ppbarTotal.begin() + i);
      i--;
    }
  }
  for (int i = 0; i < ppbarElastic.size() - 1; i++) {
    if (ppbarElastic[i].first == ppbarElastic[i + 1].first) {
      ppbarElastic.erase(ppbarElastic.begin() + i);
      i--;
    }
  }
}

#endif